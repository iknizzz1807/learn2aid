<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learn2Aid - Quiz Creator</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        padding: 20px;
        max-width: 1000px;
        margin: 0 auto;
      }

      .quiz-form {
        margin-bottom: 30px;
      }

      .question-card {
        background-color: #f8f9fa;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
        border-left: 4px solid #0d6efd;
      }

      .option-row {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }

      .option-radio {
        margin-right: 10px;
      }

      .quiz-list-item {
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .quiz-list-item:hover {
        background-color: #f1f1f1;
      }

      .question-controls {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row mb-4">
        <div class="col">
          <h1>Quiz Creator</h1>
          <p>Create and manage quizzes for Learn2Aid</p>
          <div id="login-info">
            <button id="login-button" class="btn btn-primary">
              Login with Google
            </button>
          </div>
        </div>
      </div>

      <div id="main-content" style="display: none">
        <div class="row">
          <!-- Quiz List Panel -->
          <div class="col-md-4">
            <div class="card mb-4">
              <div
                class="card-header d-flex justify-content-between align-items-center"
              >
                <h5 class="mb-0">Quizzes</h5>
                <button id="new-quiz-button" class="btn btn-primary btn-sm">
                  New Quiz
                </button>
              </div>
              <div class="card-body">
                <ul id="quiz-list" class="list-group">
                  <li class="list-group-item text-center">
                    Login to see quizzes
                  </li>
                </ul>
              </div>
            </div>

            <button id="logout-button" class="btn btn-outline-secondary btn-sm">
              Logout
            </button>
          </div>

          <!-- Quiz Editor Panel -->
          <div class="col-md-8">
            <div id="quiz-editor" class="card d-none">
              <div class="card-header">
                <h5 id="editor-title">Create New Quiz</h5>
              </div>
              <div class="card-body">
                <!-- Quiz Form -->
                <form id="quiz-form" class="quiz-form">
                  <input type="hidden" id="quiz-id" />

                  <div class="mb-3">
                    <label for="quiz-title" class="form-label"
                      >Quiz Title</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="quiz-title"
                      required
                    />
                  </div>

                  <div class="mb-3">
                    <label for="quiz-description" class="form-label"
                      >Description</label
                    >
                    <textarea
                      class="form-control"
                      id="quiz-description"
                      rows="2"
                      required
                    ></textarea>
                  </div>

                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label for="quiz-category" class="form-label"
                        >Category</label
                      >
                      <select class="form-control" id="quiz-category" required>
                        <option value="">Select a category</option>
                        <option value="basic">Basic First Aid</option>
                        <option value="cpr">CPR</option>
                        <option value="burns">Burns</option>
                        <option value="wounds">Wounds</option>
                        <option value="fractures">Fractures</option>
                        <option value="choking">Choking</option>
                        <option value="emergencies">Emergencies</option>
                      </select>
                    </div>
                    <div class="col-md-6 mb-3">
                      <label for="quiz-time-limit" class="form-label"
                        >Time Limit (seconds)</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="quiz-time-limit"
                        value="0"
                        min="0"
                        required
                      />
                      <small class="text-muted">0 means no time limit</small>
                    </div>
                  </div>

                  <!-- Questions Section -->
                  <h5 class="mt-4 mb-3">Questions</h5>
                  <div id="questions-container"></div>

                  <button
                    type="button"
                    id="add-question-button"
                    class="btn btn-outline-primary mt-3"
                  >
                    Add Question
                  </button>

                  <div class="mt-4">
                    <button type="submit" class="btn btn-success">
                      Save Quiz
                    </button>
                    <button
                      type="button"
                      id="cancel-button"
                      class="btn btn-outline-secondary"
                    >
                      Cancel
                    </button>
                    <button
                      type="button"
                      id="delete-quiz-button"
                      class="btn btn-danger float-end d-none"
                    >
                      Delete Quiz
                    </button>
                  </div>
                </form>
              </div>
            </div>

            <div id="welcome-panel" class="card">
              <div class="card-body">
                <h3>Welcome to Quiz Creator</h3>
                <p>
                  Select a quiz from the list to edit or click "New Quiz" to
                  create a new one.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Question Template (hidden) -->
    <template id="question-template">
      <div class="question-card" data-question-index="0">
        <div class="question-controls">
          <h6>Question <span class="question-number">1</span></h6>
          <button
            type="button"
            class="btn btn-outline-danger btn-sm remove-question"
          >
            Remove
          </button>
        </div>

        <div class="mb-3">
          <label class="form-label">Question Text</label>
          <input type="text" class="form-control question-text" required />
        </div>

        <div class="mb-3">
          <label class="form-label">Image URL (optional)</label>
          <input type="url" class="form-control question-image-url" />
        </div>

        <div class="mb-3">
          <label class="form-label">Options</label>
          <div class="options-container">
            <div class="option-row">
              <input
                type="radio"
                name="correct-0"
                class="option-radio"
                value="0"
                required
              />
              <input
                type="text"
                class="form-control option-text"
                placeholder="Option 1"
                required
              />
            </div>
            <div class="option-row">
              <input
                type="radio"
                name="correct-0"
                class="option-radio"
                value="1"
                required
              />
              <input
                type="text"
                class="form-control option-text"
                placeholder="Option 2"
                required
              />
            </div>
            <div class="option-row">
              <input
                type="radio"
                name="correct-0"
                class="option-radio"
                value="2"
                required
              />
              <input
                type="text"
                class="form-control option-text"
                placeholder="Option 3"
                required
              />
            </div>
            <div class="option-row">
              <input
                type="radio"
                name="correct-0"
                class="option-radio"
                value="3"
                required
              />
              <input
                type="text"
                class="form-control option-text"
                placeholder="Option 4"
                required
              />
            </div>
          </div>
        </div>
      </div>
    </template>

    <!-- Firebase SDK -->
    <script type="module" src="./script.js"></script>
  </body>
</html>

<!-- rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /quizzes/{quizId} {
      allow read: true;  // Anyone can read quizzes
      allow write: if request.auth != null;  // Any logged-in user can write
      
      match /questions/{questionId} {
        allow read: true;  // Anyone can read questions
        allow write: if request.auth != null;  // Any logged-in user can write
      }
    }
    
    match /quiz_attempts/{attemptId} {
      allow read: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
      allow update: if request.auth != null && request.auth.uid == resource.data.userId;
      allow delete: if false;  // Don't allow deleting attempts
    }
  }
} -->
